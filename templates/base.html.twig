<!DOCTYPE html>
<html lang="fr" class="dark">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}Ressources Relationnelles{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        
        {% block stylesheets %}
        {% endblock %}

        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
        <style>
            body { font-family: 'Inter', sans-serif; }
        </style>
    </head>
    <body class="bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100 min-h-screen flex flex-col antialiased selection:bg-indigo-500/30">
        <nav class="sticky top-0 z-50 w-full border-b border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center gap-8">
                        <a href="{{ path('app_home') }}" class="flex items-center gap-2 font-bold text-xl tracking-tight text-indigo-600 dark:text-indigo-400">
                            {{ ux_icon('lucide:shapes') }}
                            Ressources
                        </a>
                        <div class="hidden md:block">
                            <div class="flex items-baseline space-x-4">
                                <a href="{{ path('app_ressource_index') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors {{ app.request.attributes.get('_route') starts with 'app_ressource' ? 'bg-slate-100 dark:bg-slate-800' : '' }}">Explorer</a>
                                <a href="{{ path('app_chat_room_index') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors {{ app.request.attributes.get('_route') starts with 'app_chat' ? 'bg-slate-100 dark:bg-slate-800' : '' }}">Conversations</a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden md:block">
                        <div class="flex items-center gap-4">
                            {% if app.user %}
                                <div class="flex items-center gap-2 px-3 py-2">
                                    <div class="w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-white font-bold text-xs">
                                        {{ app.user.email|slice(0,2)|upper }}
                                    </div>
                                    <span class="text-sm font-medium">{{ app.user.nickname ?: 'Utilisateur' }}</span>
                                </div>
                                <a href="{{ path('app_logout') }}" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-slate-900 dark:bg-white dark:text-slate-900 rounded-lg hover:bg-slate-800 dark:hover:bg-slate-100 transition-colors">Déconnexion</a>
                            {% else %}
                                <a href="{{ path('app_login') }}" class="text-sm font-medium hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors">Connexion</a>
                                <a href="{{ path('app_register') }}" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm shadow-indigo-500/30">S'inscrire</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <main class="flex-grow w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 flex flex-col">
            {# Flash Messages #}
            {% for label, messages in app.flashes %}
                {% for message in messages %}
                    <div class="mb-4 p-4 rounded-lg border {{ label == 'success' ? 'bg-green-50 border-green-200 text-green-800 dark:bg-green-900/30 dark:border-green-800 dark:text-green-400' : 'bg-red-50 border-red-200 text-red-800 dark:bg-red-900/30 dark:border-red-800 dark:text-red-400' }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endfor %}

            {% block body %}{% endblock %}
        </main>
        
        <footer class="border-t border-slate-200 dark:border-slate-800 py-8 mt-auto">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="flex items-center gap-2 text-indigo-600 dark:text-indigo-400 font-bold">
                    {{ ux_icon('lucide:shapes', {height: 20, width: 20}) }}
                    Ressources Relationnelles
                </div>
                <div class="text-sm text-slate-500 dark:text-slate-400">
                    &copy; {{ 'now'|date('Y') }} Tous droits réservés.
                </div>
            </div>
        </footer>
    </body>
</html>
